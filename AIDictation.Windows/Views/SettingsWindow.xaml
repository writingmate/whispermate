<Window x:Class="AIDictation.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Settings"
        Width="600" Height="500"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        MinWidth="500" MinHeight="400"
        Background="{StaticResource BackgroundBrush}">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="160"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Sidebar -->
        <Border Grid.Column="0" Background="{StaticResource SurfaceBrush}">
            <StackPanel Margin="8,16">
                <RadioButton x:Name="AudioTab"
                             Content="ðŸ”Š Audio"
                             IsChecked="True"
                             GroupName="SettingsTabs"
                             Style="{StaticResource {x:Type RadioButton}}"
                             Margin="0,4"
                             Padding="12,8"
                             Checked="Tab_Checked"/>
                <RadioButton x:Name="RulesTab"
                             Content="ðŸ“ Context Rules"
                             GroupName="SettingsTabs"
                             Margin="0,4"
                             Padding="12,8"
                             Checked="Tab_Checked"/>
                <RadioButton x:Name="HotkeyTab"
                             Content="âŒ¨ï¸ Hotkey"
                             GroupName="SettingsTabs"
                             Margin="0,4"
                             Padding="12,8"
                             Checked="Tab_Checked"/>
                <RadioButton x:Name="ApiTab"
                             Content="ðŸ”‘ API Key"
                             GroupName="SettingsTabs"
                             Margin="0,4"
                             Padding="12,8"
                             Checked="Tab_Checked"/>
            </StackPanel>
        </Border>

        <!-- Content Area -->
        <ScrollViewer Grid.Column="1" Padding="24">
            <Grid>
                <!-- Audio Settings -->
                <StackPanel x:Name="AudioPanel">
                    <TextBlock Text="Audio" Style="{StaticResource HeadlineText}"/>

                    <TextBlock Text="Input Device"
                               Style="{StaticResource BodyText}"
                               FontWeight="SemiBold"
                               Margin="0,24,0,8"/>
                    <TextBlock Text="Select your microphone or audio input device"
                               Style="{StaticResource CaptionText}"
                               Margin="0,0,0,8"/>
                    <ComboBox x:Name="AudioDeviceCombo"
                              Width="300"
                              HorizontalAlignment="Left"
                              SelectionChanged="AudioDevice_SelectionChanged"/>

                    <TextBlock Text="Language"
                               Style="{StaticResource BodyText}"
                               FontWeight="SemiBold"
                               Margin="0,24,0,8"/>
                    <TextBlock Text="Select language for transcription"
                               Style="{StaticResource CaptionText}"
                               Margin="0,0,0,8"/>
                    <WrapPanel>
                        <RadioButton x:Name="LangAuto" Content="ðŸŒ Auto" GroupName="Language" IsChecked="True" Margin="0,4,12,4" Checked="Language_Checked"/>
                        <RadioButton x:Name="LangEn" Content="ðŸ‡ºðŸ‡¸ English" GroupName="Language" Margin="0,4,12,4" Checked="Language_Checked"/>
                        <RadioButton x:Name="LangRu" Content="ðŸ‡·ðŸ‡º Russian" GroupName="Language" Margin="0,4,12,4" Checked="Language_Checked"/>
                        <RadioButton x:Name="LangDe" Content="ðŸ‡©ðŸ‡ª German" GroupName="Language" Margin="0,4,12,4" Checked="Language_Checked"/>
                        <RadioButton x:Name="LangFr" Content="ðŸ‡«ðŸ‡· French" GroupName="Language" Margin="0,4,12,4" Checked="Language_Checked"/>
                        <RadioButton x:Name="LangEs" Content="ðŸ‡ªðŸ‡¸ Spanish" GroupName="Language" Margin="0,4,12,4" Checked="Language_Checked"/>
                    </WrapPanel>

                    <CheckBox x:Name="AutoPasteCheck"
                              Content="Automatically paste after transcription"
                              Margin="0,24,0,0"
                              Checked="AutoPaste_Changed"
                              Unchecked="AutoPaste_Changed"/>
                </StackPanel>

                <!-- Rules Settings -->
                <StackPanel x:Name="RulesPanel" Visibility="Collapsed">
                    <TextBlock Text="Context Rules" Style="{StaticResource HeadlineText}"/>
                    <TextBlock Text="Add rules to customize transcription output"
                               Style="{StaticResource CaptionText}"
                               Margin="0,4,0,16"/>

                    <Grid Margin="0,0,0,16">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBox x:Name="NewRuleTextBox"
                                 Style="{StaticResource ModernTextBox}"
                                 PlaceholderText="Add a new rule..."
                                 Grid.Column="0"/>
                        <Button Content="+"
                                Style="{StaticResource PrimaryButton}"
                                Grid.Column="1"
                                Margin="8,0,0,0"
                                Width="40"
                                Click="AddRule_Click"/>
                    </Grid>

                    <ItemsControl x:Name="RulesList">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="{StaticResource SurfaceBrush}"
                                        CornerRadius="6"
                                        Padding="12,8"
                                        Margin="0,4">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <CheckBox IsChecked="{Binding IsEnabled}"
                                                  Grid.Column="0"
                                                  VerticalAlignment="Center"/>
                                        <TextBlock Text="{Binding Text}"
                                                   Grid.Column="1"
                                                   VerticalAlignment="Center"
                                                   Margin="8,0"/>
                                        <Button Content="ðŸ—‘"
                                                Style="{StaticResource IconButton}"
                                                Grid.Column="2"
                                                Tag="{Binding}"
                                                Click="DeleteRule_Click"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>

                <!-- Hotkey Settings -->
                <StackPanel x:Name="HotkeyPanel" Visibility="Collapsed">
                    <TextBlock Text="Hotkey" Style="{StaticResource HeadlineText}"/>
                    <TextBlock Text="Configure the global hotkey for recording"
                               Style="{StaticResource CaptionText}"
                               Margin="0,4,0,24"/>

                    <Border Background="{StaticResource SurfaceBrush}"
                            BorderBrush="{StaticResource BorderBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="24,16"
                            HorizontalAlignment="Left"
                            MinWidth="200"
                            Cursor="Hand"
                            MouseLeftButtonDown="HotkeyBox_Click">
                        <TextBlock x:Name="CurrentHotkeyDisplay"
                                   Text="Click to change..."
                                   FontSize="18"
                                   HorizontalAlignment="Center"/>
                    </Border>

                    <Button Content="Clear Hotkey"
                            Style="{StaticResource SecondaryButton}"
                            HorizontalAlignment="Left"
                            Margin="0,16,0,0"
                            Click="ClearHotkey_Click"/>
                </StackPanel>

                <!-- API Settings -->
                <StackPanel x:Name="ApiPanel" Visibility="Collapsed">
                    <TextBlock Text="API Key" Style="{StaticResource HeadlineText}"/>
                    <TextBlock Text="Your OpenAI API key for transcription"
                               Style="{StaticResource CaptionText}"
                               Margin="0,4,0,24"/>

                    <TextBox x:Name="ApiKeyTextBox"
                             Style="{StaticResource ModernTextBox}"
                             Width="400"
                             HorizontalAlignment="Left"
                             PasswordChar="â€¢"
                             TextChanged="ApiKey_TextChanged"/>

                    <Button Content="Save API Key"
                            Style="{StaticResource PrimaryButton}"
                            HorizontalAlignment="Left"
                            Margin="0,16,0,0"
                            Click="SaveApiKey_Click"/>
                </StackPanel>
            </Grid>
        </ScrollViewer>
    </Grid>
</Window>
