<Window x:Class="AIDictation.Views.HistoryWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="History"
        Width="800" Height="600"
        MinWidth="600" MinHeight="400"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource BackgroundBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Search Bar -->
        <Border Grid.Row="0" Padding="16" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,0,1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <TextBlock Text="ðŸ”" FontSize="16" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <TextBox x:Name="SearchBox"
                         Grid.Column="1"
                         Style="{StaticResource ModernTextBox}"
                         BorderThickness="0"
                         Background="Transparent"
                         TextChanged="SearchBox_TextChanged"/>
            </Grid>
        </Border>

        <!-- Recording List -->
        <ScrollViewer Grid.Row="1">
            <ItemsControl x:Name="RecordingsList" Padding="16">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Background="{StaticResource BackgroundBrush}"
                                BorderBrush="{StaticResource BorderBrush}"
                                BorderThickness="0,0,0,1"
                                Padding="12"
                                x:Name="ItemBorder">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="120"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- Timestamp -->
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="{Binding Timestamp, StringFormat='{}{0:MM/dd/yyyy}'}"
                                               Style="{StaticResource BodyText}"/>
                                    <TextBlock Text="{Binding Timestamp, StringFormat='{}{0:h:mm tt}'}"
                                               Style="{StaticResource CaptionText}"/>
                                    <TextBlock Text="{Binding DurationSeconds, StringFormat='{}{0:F1}s'}"
                                               Style="{StaticResource CaptionText}"
                                               Margin="0,4,0,0"/>
                                </StackPanel>

                                <!-- Transcription -->
                                <TextBlock Grid.Column="1"
                                           Text="{Binding Transcription}"
                                           Style="{StaticResource BodyText}"
                                           TextTrimming="CharacterEllipsis"
                                           MaxHeight="60"
                                           Margin="16,0"/>

                                <!-- Actions -->
                                <StackPanel Grid.Column="2"
                                            Orientation="Horizontal"
                                            x:Name="ActionButtons"
                                            Opacity="0">
                                    <Button Content="ðŸ“‹"
                                            Style="{StaticResource IconButton}"
                                            Tag="{Binding}"
                                            Click="CopyItem_Click"
                                            ToolTip="Copy"/>
                                    <Button Content="ðŸ—‘"
                                            Style="{StaticResource IconButton}"
                                            Tag="{Binding}"
                                            Click="DeleteItem_Click"
                                            ToolTip="Delete"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                        <DataTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="ItemBorder" Property="Background" Value="{StaticResource SurfaceBrush}"/>
                                <Setter TargetName="ActionButtons" Property="Opacity" Value="1"/>
                            </Trigger>
                        </DataTemplate.Triggers>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>

        <!-- Empty State -->
        <StackPanel x:Name="EmptyState"
                    Grid.Row="1"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Center"
                    Visibility="Collapsed">
            <TextBlock Text="ðŸ“­" FontSize="48" HorizontalAlignment="Center"/>
            <TextBlock Text="No recordings yet"
                       Style="{StaticResource SecondaryText}"
                       HorizontalAlignment="Center"
                       Margin="0,16,0,0"/>
            <TextBlock Text="Your transcriptions will appear here"
                       Style="{StaticResource CaptionText}"
                       HorizontalAlignment="Center"
                       Margin="0,8,0,0"/>
        </StackPanel>

        <!-- Footer -->
        <Border Grid.Row="2" Padding="16" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,1,0,0">
            <Grid>
                <TextBlock x:Name="RecordingCount"
                           Style="{StaticResource CaptionText}"
                           VerticalAlignment="Center"/>
                <Button Content="Clear All"
                        Style="{StaticResource SecondaryButton}"
                        HorizontalAlignment="Right"
                        Click="ClearAll_Click"/>
            </Grid>
        </Border>
    </Grid>
</Window>
